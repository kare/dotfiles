#!/bin/bash

if [ -d $HOME/.dotfiles.git ]; then
    echo "Dotfiles is already installed."
    echo "Install cancelled."
    exit 1
fi

function makedir() {
    [ -d $1 ] || mkdir -vp $1
}

makedir ~/tmp
makedir ~/.vim/undo

if [ ! -x /bin/zsh ]; then
    echo "WARNING: Please install Z Shell"
fi

mkdir .dotfiles.git
git clone git@github.com:kare/dotfiles.git dotfiles.git
shopt -s extglob
mv dotfiles.git/.git/* .dotfiles.git
mv -i dotfiles.git/* .
mv -i dotfiles.git/.* .
rmdir dotfiles.git
git --git-dir=$HOME/.dotfiles.git/ --work-tree=$HOME submodule init
git --git-dir=$HOME/.dotfiles.git/ submodule update

echo "dotfiles git repository is now installed to $HOME/.dotfiles.git"
echo "actual dot files are under $HOME with correct names."
